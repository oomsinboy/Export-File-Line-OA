(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{71113:function(e,t,s){Promise.resolve().then(s.bind(s,30672))},30672:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var i=s(57437),l=s(86504),n=s(2265),a=s(38472),c=s(66648),r=s(50448),o=s(87138),d=s(19212),x=s.n(d),h=s(6920),u=s(45079),p=s(16463),m=e=>{let{items:t}=e,s=(0,p.useRouter)(),[l,a]=(0,n.useState)([]),[d,m]=(0,n.useState)(""),[f,j]=(0,n.useState)(1),[N]=(0,n.useState)(10),[w,b]=(0,n.useState)(null);(0,n.useEffect)(()=>{Array.isArray(t.all_visit)?a(t.all_visit):console.error("คาดว่า items.all_visit จะเป็นอาร์เรย์ แต่ได้:",t.all_visit)},[t]);let g=l.filter(e=>e.patient_name.toLowerCase().includes(d.toLowerCase())).reverse(),v=n.useMemo(()=>null!==w?[...g].sort((e,t)=>e[w.key]<t[w.key]?"asc"===w.direction?-1:1:e[w.key]>t[w.key]?"asc"===w.direction?1:-1:0):g,[g,w]),y=f*N,F=v.slice(y-N,y),_=e=>{e<1||e>k||j(e)},k=Math.ceil(g.length/N),C=e=>{let t="asc";w&&w.key===e&&"asc"===w.direction&&(t="desc"),b({key:e,direction:t})},A=e=>w&&w.key===e?"asc"===w.direction?(0,i.jsx)(h.G,{icon:u.foy}):(0,i.jsx)(h.G,{icon:u.u9C}):(0,i.jsx)(h.G,{icon:u.CmM}),E=async e=>{s.push("/home/patient/view-patient?id=".concat(e))};return(0,i.jsx)("div",{className:"px-8",children:(0,i.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 ",children:(0,i.jsxs)("div",{className:"min-h-[81.71dvh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:"รายการผู้ป่วย"}),(0,i.jsxs)("div",{className:"text-[#705396]",children:["ทั้งหมด ",l.length," รายการ"]})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"w-72",children:(0,i.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,i.jsx)("input",{type:"text",className:"grow",placeholder:"Search",value:d,onChange:e=>{m(e.target.value),j(1)}})})}),(0,i.jsxs)(o.default,{href:"".concat("/","home/patient/notifications-today"),className:"relative text-white w-[160px] font-light bg-[#AF88FF] btn btn-active mx-4",children:[(0,i.jsx)("span",{children:"Notifications Today"}),t.daily_noti>0&&(0,i.jsx)("div",{className:"absolute top-0 right-0 translate-x-[40%] -translate-y-[40%] text-white rounded-full bg-red-500 w-6 h-6 flex items-center justify-center",children:t.daily_noti})]}),(0,i.jsxs)(o.default,{href:"".concat("/","home/patient/new-patient"),className:"relative text-white w-40 font-light bg-[#AF88FF] btn  ",children:[(0,i.jsx)(c.default,{className:"absolute left-4",src:"/image/icon_plus.png",alt:"logo",width:20,height:20}),"Add New"]})]})]}),(0,i.jsx)("div",{className:"2xl:pt-3 flex-grow",children:(0,i.jsx)("div",{className:"overflow-x-auto ",children:(0,i.jsxs)("table",{className:"table ",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"text-center bg-[#C0B4D9] text-base text-[#461F78]",children:[(0,i.jsxs)("th",{className:"w-[398px] cursor-pointer",onClick:()=>C("timestamp"),children:["วันที่ลงทะเบียน ",A("timestamp")]}),(0,i.jsxs)("th",{className:"w-[427px] cursor-pointer",onClick:()=>C("appointment_date"),children:["วันนัดหมายตามกำหนด ",A("appointment_date")]}),(0,i.jsxs)("th",{className:"w-[450px] cursor-pointer",onClick:()=>C("patient_name"),children:["ชื่อ-นามสกุล ",A("patient_name")]}),(0,i.jsxs)("th",{className:"w-[108px] cursor-pointer",onClick:()=>C("state"),children:["สถานะ ",A("state")]}),(0,i.jsx)("th",{children:"Action"})]})}),(0,i.jsx)("tbody",{className:"text-center text-base text-[#705396]",children:F.map((e,t)=>(0,i.jsxs)("tr",{className:"border-none ".concat((t+1)%2==0?"bg-[#F4F4FE]":""),children:[(0,i.jsx)("td",{className:"w-[398px]",children:(0,r.p6)(e.timestamp)}),(0,i.jsxs)("td",{className:"w-[427px]",children:[x()(e.appointment_date).format("DD-MM-YYYY")," | ",e.appointment_time]}),(0,i.jsx)("td",{className:"w-[450px] break-words",children:e.patient_name}),(0,i.jsx)("td",{className:"w-[108px]",children:e.state}),(0,i.jsx)("td",{className:" justify-center flex",children:(0,i.jsx)("div",{className:"cursor-pointer",onClick:()=>E(e.visit_id),children:(0,i.jsx)(c.default,{src:"/image/icon_view.png",alt:"logo",width:30,height:30})})})]},t))})]})})}),(0,i.jsxs)("div",{className:"pagination mt-3 2xl:mt-4 select-none flex justify-end items-center",children:[(0,i.jsx)("button",{className:"px-3 py-1 mx-1 rounded-full bg-white text-[#461F78] cursor-pointer",onClick:()=>_(f-1),disabled:1===f,children:"<"}),(()=>{let e=[];if(k<=4)for(let t=1;t<=k;t++)e.push((0,i.jsx)("li",{className:"list-none cursor-pointer px-3 py-1 mx-1 rounded-full ".concat(f===t?"bg-[#AF88FF] text-white":"bg-white text-[#461F78]"),onClick:()=>_(t),children:t},t));else{e.push((0,i.jsx)("li",{className:"list-none cursor-pointer px-3 py-1 mx-1 rounded-full ".concat(1===f?"bg-[#AF88FF] text-white":"bg-white text-[#461F78]"),onClick:()=>_(1),children:"1"},1)),f>3&&e.push((0,i.jsx)("li",{className:"list-none px-3 py-1 mx-1",children:"..."},"start-ellipsis"));let t=Math.max(2,f-1),s=Math.min(k-1,f+1);for(let l=t;l<=s;l++)e.push((0,i.jsx)("li",{className:"list-none cursor-pointer px-3 py-1 mx-1 rounded-full ".concat(f===l?"bg-[#AF88FF] text-white":"bg-white text-[#461F78]"),onClick:()=>_(l),children:l},l));f<k-2&&e.push((0,i.jsx)("li",{className:"list-none px-3 py-1 mx-1",children:"..."},"end-ellipsis")),e.push((0,i.jsx)("li",{className:"list-none cursor-pointer px-3 py-1 mx-1 rounded-full ".concat(f===k?"bg-[#AF88FF] text-white":"bg-white text-[#461F78]"),onClick:()=>_(k),children:k},k))}return e})(),(0,i.jsx)("button",{className:"px-3 py-1 mx-1 rounded-full bg-white text-[#461F78] cursor-pointer",onClick:()=>_(f+1),disabled:f===k,children:">"})]})]})})})},f=s(46797),j=s(44785),N=function(){let[e,t]=(0,n.useState)(null),[s,c]=(0,n.useState)(!0),r=(0,p.useRouter)();return((0,n.useEffect)(()=>{j.Z.get("__user")||r.push("/")},[r]),(0,n.useEffect)(()=>{(async()=>{try{let e=await a.Z.get("https://colonoscopytuh.com/backend/api/visit/");t(e.data)}catch(e){console.error("Error fetching data:",e)}finally{c(!1)}})()},[]),s)?(0,i.jsxs)("div",{className:"min-h-screen",children:[(0,i.jsx)(l.Z,{}),(0,i.jsx)(f.o,{})]}):(0,i.jsxs)("div",{className:"min-h-screen",children:[(0,i.jsx)(l.Z,{}),e&&(0,i.jsx)(m,{items:e})]})}}},function(e){e.O(0,[461,990,676,236,648,495,920,304,971,23,744],function(){return e(e.s=71113)}),_N_E=e.O()}]);