(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{9598:function(e,t,s){Promise.resolve().then(s.bind(s,977))},977:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),l=s(6504),n=s(2265),i=s(6648),c=s(448),r=s(8472),d=s(4379),x=s.n(d),m=e=>{let{response:t}=e,{patient:{fname:s,lname:n,idcard:i,dob:c,register_time:r,appointment_date:d,appointment_time:x,otp:m,med:o}}=t,p=d.split("T")[0],u="".concat(p,"T").concat(x);return(0,a.jsxs)("div",{className:"min-h-screen",children:[(0,a.jsx)(l.default,{}),(0,a.jsx)("div",{className:"px-8",children:(0,a.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 flex justify-center",children:(0,a.jsxs)("div",{className:"min-h-[81.71dvh] w-[70%] flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:"เพิ่มผู้ป่วยใหม่"})}),(0,a.jsxs)("form",{action:"",className:" mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"w-1/2 pr-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,a.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow text-[#705396]",value:s,readOnly:!0})})]})}),(0,a.jsx)("div",{className:"w-1/2 pl-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"นามสกุล"}),(0,a.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow text-[#705396]",value:n,readOnly:!0})})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"w-1/2 pr-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,a.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow text-[#705396]",value:i,maxLength:13,pattern:"\\d{13}",readOnly:!0})})]})}),(0,a.jsx)("div",{className:"w-1/2 pl-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),(0,a.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"date",className:"grow text-[#705396]",value:c,readOnly:!0})})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"w-1/2 pr-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,a.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:r,readOnly:!0})})]})}),(0,a.jsx)("div",{className:"w-1/2 pl-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),(0,a.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"datetime-local",className:"grow text-[#705396]",value:u,readOnly:!0})})]})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ควรหยุดรับประทาน"})}),(0,a.jsxs)("div",{className:"rounded bg-[#E8DBF5] min-h-[40dvh] p-3",children:[(0,a.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",o.length," รายการ"]}),(0,a.jsx)("div",{className:"max-h-[45dvh] overflow-y-auto",children:o.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between pt-2",children:[(0,a.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.medic,disabled:!0,children:(0,a.jsx)("option",{value:e.medic,children:e.medic})}),(0,a.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",defaultValue:e.val,disabled:!0,children:(0,a.jsxs)("option",{value:e.val,children:[e.val," วัน"]})})]},t))})]})]}),(0,a.jsx)("div",{className:"w-1/2 pl-4 flex justify-center items-center",children:(0,a.jsxs)("div",{className:"text-center w-1/2",children:[(0,a.jsx)("div",{className:"text-[#461F78] text-3xl font-semibold my-2",children:"OTP"}),(0,a.jsx)("div",{className:"text-[#705396] my-2",children:"รหัสนี้ใช้สำหรับลงทะเบียนผู้ใช้งาน Line OA"}),(0,a.jsx)("div",{className:"p-10 bg-[#F8F5FB] my-2",children:(0,a.jsx)("span",{className:"text-[#7F57D0] text-4xl tracking-widest",children:m})})]})})]})]})})})]})},o=s(6463),p=function(){let e=(0,o.useSearchParams)(),[t,s]=(0,n.useState)(null),[d,p]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),[j,f]=(0,n.useState)(""),[g,N]=(0,n.useState)(""),[v,w]=(0,n.useState)(""),[b,y]=(0,n.useState)(""),[F,S]=(0,n.useState)([]),[C,T]=(0,n.useState)([]),[B,D]=(0,n.useState)({}),[O,_]=(0,n.useState)({}),[k,E]=(0,n.useState)(""),[U,P]=(0,n.useState)(null);(0,n.useEffect)(()=>{s(e.get("id")),r.Z.get("https://city.planetcloud.cloud/citybackend/lineoa/medical").then(e=>{T(e.data)}).catch(e=>{console.error("Error fetching data:",e)});let t=setInterval(()=>{w((0,c.e)())},1e3);return()=>clearInterval(t)},[e]);let L=e=>{S(F.filter(t=>t.id!==e))},M=(e,t)=>{let s=e.target.value;F.some(e=>e.name===s&&e.id!==t&&"other"!==s)?x().fire({title:"ขออภัย",text:"รายการยานี้ถูกเลือกแล้ว",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}}):S(F.map(e=>e.id===t?{...e,name:s,isOther:"other"===s}:e))},H=(e,t)=>{D({...B,[t]:e.target.value}),S(F.map(s=>s.id===t?{...s,name:e.target.value}:s))},I=(e,t)=>{S(F.map(s=>s.id===t?{...s,dose:e.target.value}:s))},Y=async()=>{if(F.some(e=>!e.name||!e.dose)){E("กรุณากรอกข้อมูลยาและจำนวนวันที่รับประทานให้ครบถ้วน");return}E("");let e=F.map(e=>({val:e.dose,medic:e.name})),t={};if(d.trim()||(t.firstname="กรุณากรอกชื่อ"),u.trim()||(t.lastname="กรุณากรอกนามสกุล"),j.trim()?13!==j.trim().length&&(t.idCard="กรุณากรอกบัตรประจำตัวประชาชนให้ถูกต้อง (13 หลัก)"):t.idCard="กรุณากรอกบัตรประจำตัวประชาชน",g.trim()||(t.birthDate="กรุณากรอกวันเดือนปีเกิด"),b.trim()){let e=new Date(v);(new Date(b).getTime()-e.getTime())/864e5<=4&&(t.appointmentDate="กรุณากรอกวันนัดหมายที่มากกว่าวันปัจจุบัน 5 วัน")}else t.appointmentDate="กรุณากรอกวันนัดหมาย";if(Object.keys(t).length>0){_(t);return}_({});let s=JSON.stringify(e),a=new FormData;a.append("fname",d),a.append("lname",u),a.append("idcard",j),a.append("dob",g),a.append("appointment_date",b.split("T")[0]),a.append("appointment_time",b.split("T")[1]),a.append("med",s);try{let e=await r.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","patient"),a);200===e.status?(P(e.data),x().fire({title:"สำเร็จ",text:"คุณได้ทำรายการเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"})):x().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),x().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}},Z=async()=>{if(!t){console.error("saveId is null");return}if(F.some(e=>!e.name||!e.dose)){E("กรุณากรอกข้อมูลยาและจำนวนวันที่รับประทานให้ครบถ้วน");return}E("");let e=F.map(e=>({val:e.dose,medic:e.name})),s={};if(d.trim()||(s.firstname="กรุณากรอกชื่อ"),u.trim()||(s.lastname="กรุณากรอกนามสกุล"),j.trim()?13!==j.trim().length&&(s.idCard="กรุณากรอกบัตรประจำตัวประชาชนให้ถูกต้อง (13 หลัก)"):s.idCard="กรุณากรอกบัตรประจำตัวประชาชน",g.trim()||(s.birthDate="กรุณากรอกวันเดือนปีเกิด"),b.trim()){let e=new Date(v);(new Date(b).getTime()-e.getTime())/864e5<=4&&(s.appointmentDate="กรุณากรอกวันนัดหมายที่มากกว่าวันปัจจุบัน 5 วัน")}else s.appointmentDate="กรุณากรอกวันนัดหมาย";if(Object.keys(s).length>0){_(s);return}_({});let a=JSON.stringify(e),l=new FormData;l.append("fname",d),l.append("lname",u),l.append("idcard",j),l.append("dob",g),l.append("appointment_date",b.split("T")[0]),l.append("appointment_time",b.split("T")[1]),l.append("med",a),l.append("patient_id",t),console.log(t);try{let e=await r.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","visit/newappointment"),l);200===e.status?(P(e.data),x().fire({title:"สำเร็จ",text:"คุณได้ทำรายการเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"})):x().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),x().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}},A=async()=>{t?Z():Y()};return U?(0,a.jsx)(m,{response:U}):(0,a.jsxs)("div",{className:"min-h-screen",children:[(0,a.jsx)(l.default,{}),(0,a.jsx)("div",{className:"px-8",children:(0,a.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 flex justify-center",children:(0,a.jsxs)("div",{className:"min-h-[81.71dvh] w-[70%] flex flex-col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:"เพิ่มผู้ป่วยใหม่"})}),(0,a.jsxs)("form",{action:"",className:" mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"w-1/2 pr-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,a.jsx)("label",{className:" input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow text-[#705396]",value:d,onChange:e=>p(e.target.value)})}),O.firstname&&(0,a.jsx)("span",{className:"text-red-500",children:O.firstname})]})}),(0,a.jsx)("div",{className:"w-1/2 pl-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396] ",children:"นามสกุล"}),(0,a.jsx)("label",{className:" input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow text-[#705396]",value:u,onChange:e=>h(e.target.value)})}),O.lastname&&(0,a.jsx)("span",{className:"text-red-500",children:O.lastname})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"w-1/2 pr-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,a.jsx)("label",{className:" input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow text-[#705396]",value:j,onChange:e=>{let t=e.target.value;/^\d{0,13}$/.test(t)&&f(t)},maxLength:13,pattern:"\\d{13}",title:"กรุณากรอกตัวเลข 13 หลัก"})}),O.idCard&&(0,a.jsx)("span",{className:"text-red-500",children:O.idCard})]})}),(0,a.jsx)("div",{className:"w-1/2 pl-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),(0,a.jsx)("label",{className:" input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"date",className:"grow text-[#705396]",value:g,onChange:e=>N(e.target.value)})}),O.birthDate&&(0,a.jsx)("span",{className:"text-red-500",children:O.birthDate})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"w-1/2 pr-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,a.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:v,readOnly:!0})})]})}),(0,a.jsx)("div",{className:"w-1/2 pl-4",children:(0,a.jsxs)("div",{className:"my-2",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),(0,a.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,a.jsx)("input",{type:"datetime-local",className:"grow text-[#705396]",value:b,onChange:e=>y(e.target.value)})}),O.appointmentDate&&(0,a.jsx)("span",{className:"text-red-500",children:O.appointmentDate})]})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ควรหยุดรับประทาน"}),(0,a.jsx)("button",{className:"mx-2",onClick:()=>{S([...F,{id:Date.now(),name:"",dose:"",isOther:!1}])},children:(0,a.jsx)(i.default,{src:"/image/icon_addplus.png",alt:"logo",width:30,height:30})})]}),k&&(0,a.jsx)("span",{className:"text-red-500",children:k}),(0,a.jsxs)("div",{className:"rounded bg-[#E8DBF5] min-h-[40dvh] p-3",children:[(0,a.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",F.length," รายการ"]}),(0,a.jsx)("div",{className:"max-h-[45dvh] overflow-y-auto",children:F.map(e=>(0,a.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,a.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:B[e.id]||"",onChange:t=>H(t,e.id),placeholder:"ระบุชื่อยา"}):(0,a.jsxs)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:e.name,onChange:t=>M(t,e.id),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"เลือกยา"}),C.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id)),(0,a.jsx)("option",{value:"other",children:"อื่นๆ"})]}),(0,a.jsxs)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",value:e.dose,onChange:t=>I(t,e.id),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"วัน"}),[...Array(7)].map((e,t)=>(0,a.jsxs)("option",{value:t+1,children:[t+1," วัน"]},t+1))]}),(0,a.jsx)("button",{className:"mx-1",onClick:()=>L(e.id),children:(0,a.jsx)(i.default,{src:"/image/icon_delete.png",alt:"delete medication",width:30,height:30})})]},e.id))})]})]}),(0,a.jsx)("div",{className:"my-44 w-1/2",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{onClick:A,className:"text-white w-80 text-2xl font-light bg-[#BE77F1] btn btn-active mx-4",children:"Save & Generate OTP"})})})]})]})})})]})}},6504:function(e,t,s){"use strict";var a=s(7437);s(2265);var l=s(6648),n=s(7138),i=s(4379),c=s.n(i),r=s(6463);t.default=()=>{let e=(0,r.useRouter)();return(0,a.jsx)("div",{className:"p-8 pb-2",children:(0,a.jsxs)("div",{className:" rounded-[15px] bg-white px-2 py-1 flex justify-between",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(l.default,{src:"/image/logo_colonoscopy_small.png",alt:"logo",width:80,height:80}),(0,a.jsx)("div",{className:"flex items-center text-xl text-[#9b88c0] font-medium select-none ",children:(0,a.jsx)("h1",{children:"COLONOSCOPY TUH"})}),(0,a.jsxs)(n.default,{href:"".concat("/","home"),className:"ml-10 text-[#461F78] flex items-center text-xl font-bold select-none",children:[(0,a.jsx)("div",{children:(0,a.jsx)(l.default,{src:"/image/icon_home.png",alt:"logo",width:30,height:30})}),(0,a.jsx)("h1",{className:"mx-2",children:"หน้าหลัก"})]}),(0,a.jsxs)(n.default,{href:"#",onClick:()=>e.back(),className:"mx-5 text-[#461F78] flex items-center text-xl font-bold select-none",children:[(0,a.jsx)("div",{children:(0,a.jsx)(l.default,{src:"/image/icon_back.png",alt:"logo",width:30,height:30})}),(0,a.jsx)("h1",{className:"mx-2",children:"ย้อนกลับ"})]})]}),(0,a.jsx)("div",{className:"flex",children:(0,a.jsxs)("div",{onClick:e=>{e.preventDefault(),c().fire({title:"ยืนยันการออกจากระบบ",text:"คุณกำลังออกจากระบบ ต้องการดำเนินการต่อหรือไม่ ?",icon:"warning",showCancelButton:!0,cancelButtonText:"ยกเลิก",confirmButtonText:"ยืนยัน",reverseButtons:!1,customClass:{icon:"custom-swal2-warning"}}).then(e=>{e.isConfirmed&&c().fire({title:"ออกจากระบบ!",text:"คุณได้ออกจากระบบแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.href="".concat("/")})})},className:"cursor-pointer mx-16 text-[#461F78] flex items-center text-xl font-bold select-none",children:[(0,a.jsx)("div",{children:(0,a.jsx)(l.default,{src:"/image/icon_out.png",alt:"logo",width:30,height:30})}),(0,a.jsx)("h1",{className:"mx-2",children:"ออกจากระบบ"})]})})]})})}},448:function(e,t,s){"use strict";s.d(t,{e:function(){return l},p:function(){return a}});let a=e=>{let t=new Date(e),s=t.getUTCFullYear(),a=String(t.getUTCMonth()+1).padStart(2,"0"),l=String(t.getUTCDate()).padStart(2,"0"),n=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0"),c=String(t.getUTCSeconds()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(l," ").concat(n,":").concat(i,":").concat(c)},l=()=>{let e=new Date(new Date().getTime()),t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a," ").concat(l,":").concat(n,":").concat(i)}}},function(e){e.O(0,[461,236,648,138,971,23,744],function(){return e(e.s=9598)}),_N_E=e.O()}]);