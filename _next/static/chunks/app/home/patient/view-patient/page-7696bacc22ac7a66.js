(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[527],{68259:function(e,t,a){Promise.resolve().then(a.bind(a,52682))},55055:function(e,t,a){!function(e){e.defineLocale("th",{months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),monthsParseExact:!0,weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},meridiemParse:/ก่อนเที่ยง|หลังเที่ยง/,isPM:function(e){return"หลังเที่ยง"===e},meridiem:function(e,t,a){return e<12?"ก่อนเที่ยง":"หลังเที่ยง"},calendar:{sameDay:"[วันนี้ เวลา] LT",nextDay:"[พรุ่งนี้ เวลา] LT",nextWeek:"dddd[หน้า เวลา] LT",lastDay:"[เมื่อวานนี้ เวลา] LT",lastWeek:"[วัน]dddd[ที่แล้ว เวลา] LT",sameElse:"L"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",ss:"%d วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",w:"1 สัปดาห์",ww:"%d สัปดาห์",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"}})}(a(19212))},57818:function(e,t,a){"use strict";a.d(t,{default:function(){return l.a}});var s=a(50551),l=a.n(s)},50551:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let s=a(99920);a(57437),a(2265);let l=s._(a(40148));function n(e,t){var a;let s={loading:e=>{let{error:t,isLoading:a,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e);let n={...s,...t};return(0,l.default)({...n,modules:null==(a=n.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},10912:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let s=a(55592);function l(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new s.BailoutToCSRError(t);return a}},40148:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let s=a(57437),l=a(2265),n=a(10912),i=a(61481);function d(e){return{default:e&&"default"in e?e.default:e}}let r={loader:()=>Promise.resolve(d(()=>null)),loading:null,ssr:!0},c=function(e){let t={...r,...e},a=(0,l.lazy)(()=>t.loader().then(d)),c=t.loading;function o(e){let d=c?(0,s.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,r=t.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(i.PreloadCss,{moduleIds:t.modules}):null,(0,s.jsx)(a,{...e})]}):(0,s.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(l.Suspense,{fallback:d,children:r})}return o.displayName="LoadableComponent",o}},61481:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return n}});let s=a(57437),l=a(58512);function n(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,l.getExpectedRequestStore)("next/dynamic css"),n=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));n.push(...t)}}return 0===n.length?null:(0,s.jsx)(s.Fragment,{children:n.map(e=>(0,s.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},52682:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return B}});var s=a(57437),l=a(86504),n=a(2265),i=a(16463),d=a(38472),r=a(50448),c=a(19212),o=a.n(c);a(55055),o().locale("th");var m=e=>{let{items:t}=e,a=t.patient.appointment_date.split("T")[0],l=o()("".concat(a,"T").concat(t.patient.appointment_time)).format("DD-MM-YYYY HH:mm:ss");return(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 flex justify-center",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] w-[70%] flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:"เพิ่มผู้ป่วยใหม่"})}),(0,s.jsxs)("form",{action:"",className:" mt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.patient_fname,readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"นามสกุล"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.patient_lname,readOnly:!0})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.id_card,maxLength:13,pattern:"\\d{13}",readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.dob?o()(t.patient.dob).format("DD-MM-YYYY"):"",readOnly:!0})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:(0,r.p)(t.patient.register_date),readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:l,readOnly:!0})})]})})]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ต้องหยุดรับประทาน"})}),(0,s.jsxs)("div",{className:"rounded bg-[#E8DBF5] min-h-[36dvh] 2xl:min-h-[40dvh] p-3",children:[(0,s.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",t.patient.med.length," รายการ"]}),(0,s.jsx)("div",{className:"max-h-[30dvh] 2xl:max-h-[35dvh] overflow-y-auto",children:t.patient.med.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[(0,s.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.medic,disabled:!0,children:(0,s.jsx)("option",{value:e.medic,children:e.medic})}),(0,s.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",defaultValue:e.val,disabled:!0,children:(0,s.jsxs)("option",{value:e.val,children:[e.val," วัน"]})})]},t))})]})]}),(0,s.jsx)("div",{className:"w-1/2 pl-4 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"text-center w-1/2",children:[(0,s.jsx)("div",{className:"text-[#461F78] text-3xl font-semibold my-2",children:"OTP"}),(0,s.jsx)("div",{className:"text-[#705396] my-2",children:"รหัสนี้ใช้สำหรับลงทะเบียนผู้ใช้งาน Line OA"}),(0,s.jsx)("div",{className:"p-10 bg-[#F8F5FB] my-2",children:(0,s.jsx)("span",{className:"text-[#7F57D0] text-4xl tracking-widest",children:t.patient.otp})})]})})]})]})})})},x=a(46797),p=a(66648),h=e=>{let{isVisible:t,onClose:a,title:l,children:n}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex justify-center items-center",children:(0,s.jsx)("div",{className:"w-[80%] animate-modalOpen",children:(0,s.jsxs)("div",{className:"relative bg-white p-3 rounded",children:[(0,s.jsx)("div",{className:"absolute right-2",children:(0,s.jsx)("button",{onClick:()=>a(),children:(0,s.jsx)(p.default,{src:"/image/icon_close.png",alt:"logo",width:30,height:30})})}),n]})})}):null},u=a(64379),f=a.n(u),j=a(57818);a(18416);let v=(0,j.default)(()=>Promise.all([a.e(70),a.e(436)]).then(a.t.bind(a,98436,23)),{loadableGenerated:{webpack:()=>[98436]},ssr:!1});o().locale("th");var g=e=>{let{visit_id:t,dailyDetail:a,notilist:l}=e,[i,r]=(0,n.useState)(!1),[c,m]=(0,n.useState)(null),[x,u]=(0,n.useState)(!1),[j,g]=(0,n.useState)(""),[b,N]=(0,n.useState)(0),[w,y]=(0,n.useState)(o()()),_=w.clone().startOf("month").startOf("week"),F=w.clone().endOf("month").endOf("week"),Y=_.clone().subtract(1,"day"),B=[];for(;Y.isBefore(F,"day");)B.push(Array(7).fill(0).map(()=>Y.add(1,"day").clone()));let D=e=>e.isSame(w,"month"),S=e=>{m(e),g(e.noti_detail||""),r(!0)},C=async()=>{let e=0===b?c.noti_id:b.toString(),a=new FormData;a.append("visit_id",t.toString()),a.append("noti_id",e),a.append("noti_detail",j);try{let e=await d.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","daily_noti/task/").concat(c.daily_id),a);200===e.status?(u(!1),f().fire({title:"สำเร็จ",text:"คุณได้การแก้ไขเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.reload()})):f().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),f().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}};return(0,s.jsxs)("div",{className:"pl-8 pt-4 2xl:pt-10",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center ",children:[(0,s.jsx)("button",{onClick:()=>{y(w.clone().subtract(1,"month"))},children:(0,s.jsx)(p.default,{src:"/image/icon_left.png",alt:"logo",width:15,height:15})}),(0,s.jsx)("span",{className:"text-lg font-semibold text-[#BE77F1]",children:w.format("MMMM YYYY")}),(0,s.jsx)("button",{onClick:()=>{y(w.clone().add(1,"month"))},children:(0,s.jsx)(p.default,{src:"/image/icon_right.png",alt:"logo",width:15,height:15})})]}),(()=>{let e=o().weekdays(!0);return(0,s.jsx)("div",{className:"grid grid-cols-7 bg-[#B498F0] text-white rounded mt-4",children:e.map(e=>(0,s.jsx)("div",{className:"text-center py-2",children:e},e))})})(),(0,s.jsx)("div",{className:"grid grid-cols-7",children:B.map((e,t)=>(0,s.jsx)("div",{className:"contents",children:e.map((e,t)=>{let l=a.some((t,s)=>o()(t.date_before_appointment).isSame(e,"day")&&s===a.length-1);return(0,s.jsxs)("div",{className:"relative flex justify-end items-end text-center h-[88px] 2xl:h-24 p-2 w-full border ".concat(D(e)?"":"text-gray-400"),children:[a.map((t,l)=>{if(o()(t.date_before_appointment).isSame(e,"day")){let n=0===l,i=o()().isSame(e,"day"),d=e.isBefore(o()(),"day");return(0,s.jsxs)("div",{children:[n&&(0,s.jsx)("div",{className:"w-[calc(100%-8px)] absolute top-1 left-1 text-white bg-[#BE77F1] p-1 rounded",children:"ลงทะเบียน"}),l===a.length-1?(0,s.jsx)("div",{className:"h-[calc(100%-8px)] w-[calc(100%-8px)] absolute top-1 left-1 text-center text-white p-1 rounded ".concat(i||!d?"bg-[#BE77F1]":"bg-[#AEB2B5]"),children:"ส่องกล้อง"}):(0,s.jsx)("button",{className:"absolute bottom-2 left-2 rounded text-white w-7 h-7 font-light flex justify-center items-center ".concat(n?"bg-[#AEB2B5] hover:bg-[#e5e7eb]":i||!d?"bg-[#705396] hover:bg-[#BE77F1]":"bg-[#AEB2B5] hover:bg-[#e5e7eb]"),onClick:()=>S(t),children:(0,s.jsx)(p.default,{className:"gap-2",src:n?"/image/icon_edit_pass.png":i||!d?"/image/icon_edit.png":"/image/icon_edit_pass.png",alt:"logo",width:20,height:20})})]},t.date_before_appointment)}return null}),(0,s.jsx)("div",{className:"absolute bottom-2 right-3 ".concat(l?"text-white":""),children:e.format("D")})]},t)})},t))}),(0,s.jsx)(h,{isVisible:i,onClose:()=>{r(!1),u(!1),g(c&&c.noti_detail||"")},title:"รายละเอียดการแจ้งเตือน",children:c&&(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:["แจ้งเตือนคุณ ",c.ptname]}),(0,s.jsxs)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:["วันที่ ",c.date_before_appointment]}),(0,s.jsx)("div",{className:"rounded ".concat(x?"bg-white py-2":" bg-[#E8DBF5] p-3","  min-h-[48dvh]  2xl:mt-2 text-xl mb-16"),children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("select",{className:"w-full mb-4 p-2 border rounded",value:b,onChange:e=>{let t=parseInt(e.target.value,10);N(t);let a=l.find(e=>e.id===t);g(a?a.detail:"")},children:[(0,s.jsx)("option",{value:0,disabled:!0,children:"เลือกการแจ้งเตือน"}),l.map(e=>(0,s.jsx)("option",{value:e.id,children:e.header},e.id))]}),(0,s.jsx)(v,{className:"h-[280px] 2xl:h-[360px]",value:j,onChange:e=>g(e),theme:"snow"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"my-2",children:"ข้อควรปฏิบัติก่อนรับการตรวจส่องกล้องลำไส้ใหญ่"}),(0,s.jsx)("div",{className:"break-words max-h-[460px]",dangerouslySetInnerHTML:{__html:c.noti_detail||""}})]})}),!o()(c.date_before_appointment).isBefore(o()(),"day")&&(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsxs)("button",{onClick:x?C:()=>{u(!0)},className:"relative text-white w-38 font-light btn btn-active mx-4 ".concat(x?"bg-[#693092]":"bg-[#AF88FF]"),children:[(0,s.jsx)(p.default,{className:"gap-2",src:x?"/image/icon_save.png":"/image/icon_edit.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:x?"Save":"Edit"})]})})]})})]})},b=a(91322),N=a(40286),w=a(54952),y=a(72247);let _=(0,j.default)(()=>Promise.all([a.e(70),a.e(436)]).then(a.t.bind(a,98436,23)),{loadableGenerated:{webpack:()=>[98436]},ssr:!1});o().locale("th");var F=e=>{let{items:t,fetchDataview:a}=e,[l,i]=(0,n.useState)(!1),[c,m]=(0,n.useState)(t.patient.patient_fname),[x,u]=(0,n.useState)(t.patient.patient_lname),[j,v]=(0,n.useState)(t.patient.id_card),[F,Y]=(0,n.useState)(o()(t.patient.dob)),[B,D]=(0,n.useState)(o()("".concat(t.patient.appointment_date.split("T")[0],"T").concat(t.patient.appointment_time))),[S,C]=(0,n.useState)(t.patient.line_name),[M,O]=(0,n.useState)([]),[k,T]=(0,n.useState)([]),[E,P]=(0,n.useState)({}),[L,H]=(0,n.useState)({}),[A,I]=(0,n.useState)(""),[R,Z]=(0,n.useState)([]),[V,W]=(0,n.useState)(!1),[Q,G]=(0,n.useState)(null),[U,J]=(0,n.useState)(""),[q,z]=(0,n.useState)(0);(0,n.useEffect)(()=>{let e=async()=>{try{let e=await d.Z.get("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","notification"));Z(e.data)}catch(e){console.error("Error fetching noti data:",e)}};(async()=>{try{let e=(await d.Z.get("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","medical"))).data;if(T(e),t.patient.med){let a=t.patient.med.map((t,a)=>{let s=e.some(e=>e.name===t.medic);return{id:a,name:t.medic,dose:t.val,isOther:!s}});O(a)}}catch(e){console.error("Error fetching medical data:",e)}})(),e()},[t.patient.med]);let K=async()=>{let e=M.some(e=>!e.name||!e.dose),a=o()().startOf("day"),s=F?o()(F).startOf("day"):null,l=s?a.diff(s,"years"):null;if(e){I("กรุณากรอกข้อมูลยาและจำนวนวันที่รับประทานให้ครบถ้วน");return}I("");let n={};if(c.trim()||(n.firstname="กรุณากรอกชื่อ"),x.trim()||(n.lastname="กรุณากรอกนามสกุล"),j.trim()?13!==j.trim().length&&(n.idCard="กรุณากรอกบัตรประจำตัวประชาชนให้ถูกต้อง (13 หลัก)"):n.idCard="กรุณากรอกบัตรประจำตัวประชาชน",F?(null===l||l<1)&&(n.birthDate="กรุณากรอกวันเดือนปีเกิดที่มากกว่าหรือเท่ากับ 1 ปี"):n.birthDate="กรุณากรอกวันเดือนปีเกิด",B){let e=o().utc(t.patient.register_date).startOf("day");5>B.diff(e,"days")&&(n.appointmentDate="กรุณากรอกวันนัดหมายที่มากกว่าวันลงทะเบียน 5 วัน")}else n.appointmentDate="กรุณากรอกวันนัดหมาย";if(Object.keys(n).length>0){H(n);return}H({}),await es()},X=e=>{O(M.filter(t=>t.id!==e))},$=(e,t)=>{let a=e.target.value;M.some(e=>e.name===a&&e.id!==t&&"other"!==a)?f().fire({title:"ขออภัย",text:"รายการยานี้ถูกเลือกแล้ว",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}}):O(M.map(e=>{if(e.id===t){let t="other"===a||!k.some(e=>e.name===a);return{...e,name:a,isOther:t}}return e}))},ee=(e,t)=>{P({...E,[t]:e.target.value}),O(M.map(a=>a.id===t?{...a,name:e.target.value}:a))},et=(e,t)=>{O(M.map(a=>a.id===t?{...a,dose:e.target.value}:a))},ea=async()=>{let e={visit_id:t.patient.visit_id,userId:t.patient.line_id};try{let t=await d.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","visit/line/renew"),e);200===t.status?C(t.data.line_name):console.error("Failed to refresh data")}catch(e){console.error("Error while refreshing data:",e)}},es=async()=>{let e=JSON.stringify(M.map(e=>({val:e.dose,medic:e.name}))),a=new FormData;a.append("fname",c),a.append("lname",x),a.append("idcard",j),a.append("dob",F?F.format("YYYY-MM-DD"):""),a.append("appointment_date",B?B.format("YYYY-MM-DD"):""),a.append("appointment_time",B?B.format("HH:mm:ss"):""),a.append("patient_id",String(t.patient.patient_id)),a.append("med",e);try{let e=await d.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","visit/task/").concat(t.patient.visit_id),a);200===e.status?(i(!1),f().fire({title:"สำเร็จ",text:"คุณได้ทำการแก้ไขเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.reload()})):f().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),f().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}},el=t.daily_detail.slice(1,t.daily_detail.length-1).some(e=>o()().isSame(e.date_before_appointment,"day")),en=e=>{G(e),J(e.noti_detail||""),W(!0)},ei=async()=>{let e=new FormData,a=0===q?Q.noti_id:q.toString();e.append("visit_id",t.patient.visit_id.toString()),e.append("noti_id",a),e.append("noti_detail",U);try{let t=await d.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","daily_noti/task/").concat(Q.daily_id),e);200===t.status?f().fire({title:"สำเร็จ",text:"คุณได้การแก้ไขเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.reload()}):f().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),f().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}};return(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 ",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:"ลงทะเบียนผู้ป่วย"})}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("button",{onClick:l?K:()=>{i(!0)},className:"relative text-white w-38 font-light btn btn-active mx-4 ".concat(l?"bg-[#693092]":"bg-[#AF88FF]"),children:[(0,s.jsx)(p.default,{className:"gap-2",src:l?"/image/icon_save.png":"/image/icon_edit.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:l?"Save":"Edit"})]})})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:" w-[55%]",children:[(0,s.jsxs)("form",{action:"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"".concat(l?"":"bg-[#F8F5FB]"," input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:c,onChange:e=>m(e.target.value)})}),L.firstname&&(0,s.jsx)("span",{className:"text-red-500",children:L.firstname})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"นามสกุล"}),(0,s.jsx)("label",{className:"".concat(l?"":"bg-[#F8F5FB]"," input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:x,onChange:e=>u(e.target.value)})}),L.lastname&&(0,s.jsx)("span",{className:"text-red-500",children:L.lastname})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"".concat(l?"":"bg-[#F8F5FB]"," input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:j,maxLength:13,pattern:"\\d{13}",readOnly:!l,onChange:e=>v(e.target.value)})}),L.idCard&&(0,s.jsx)("span",{className:"text-red-500",children:L.idCard})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),l?(0,s.jsx)(w._,{dateAdapter:y.Q,children:(0,s.jsx)(b.M,{value:F,format:"DD-MM-YYYY",onChange:e=>Y(e),disabled:!l,slotProps:{textField:{fullWidth:!0,className:"".concat(l?"":"bg-[#F8F5FB]"," rounded-lg text-[#705396] hover:border-gray-500 h-[48px]"),InputProps:{style:{borderRadius:"8px",color:"#705396"},className:"w-full rounded-lg text-[#705396] focus:border-gray-500 h-[48px]"}}}})}):(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:F?F.format("DD-MM-YYYY"):"",readOnly:!0})}),L.birthDate&&(0,s.jsx)("span",{className:"text-red-500",children:L.birthDate})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:(0,r.p)(t.patient.register_date),readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),l?(0,s.jsx)(w._,{dateAdapter:y.Q,children:(0,s.jsx)(N.x,{value:B,format:"DD-MM-YYYY HH:mm:ss",onChange:e=>D(e),disabled:!l,slotProps:{textField:{fullWidth:!0,className:"".concat(l?"":"bg-[#F8F5FB]"," rounded-lg text-[#705396] hover:border-gray-500 h-[48px]"),InputProps:{style:{borderRadius:"8px",color:"#705396"},className:"w-full rounded-lg text-[#705396] focus:border-gray-500 h-[48px]"}}}})}):(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:B?B.format("DD-MM-YYYY HH:mm:ss"):"",readOnly:!0})}),L.appointmentDate&&(0,s.jsx)("span",{className:"text-red-500",children:L.appointmentDate})]})})]})]}),(0,s.jsxs)("div",{className:"my-2 relative  ".concat(el?"w-full":"w-1/2 pr-4"),children:[(0,s.jsxs)("div",{className:"flex ".concat(el?"h-[50px]":"h-[30px]"),children:[(0,s.jsx)("span",{className:"text-[#705396]  ".concat(el?"flex items-center":""," "),children:el?"ข้อความที่ต้องส่งวันที่ ".concat(o()().format("DD-MM-YYYY")):"เลือกยาที่ต้องหยุดรับประทาน"}),!el&&l&&(0,s.jsx)("button",{className:"mx-2",onClick:()=>{O([...M,{id:Date.now(),name:"",dose:"",isOther:!1}])},children:(0,s.jsx)(p.default,{src:"/image/icon_addplus.png",alt:"add medication",width:30,height:30})})]}),A&&(0,s.jsx)("span",{className:"text-red-500",children:A}),(0,s.jsx)("div",{className:"rounded bg-[#E8DBF5] ".concat(A?"min-h-[36dvh] 2xl:min-h-[42dvh]":"min-h-[38dvh] 2xl:min-h-[44dvh]"," p-3"),children:el?(0,s.jsx)("div",{className:"",children:t.daily_detail.filter(e=>o()(e.date_before_appointment).isSame(o()(),"day")).map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"items-center m-2",children:[(0,s.jsx)("div",{className:"flex",children:null===(a=e.noti_image)||void 0===a?void 0:a.map((e,t)=>(0,s.jsx)(p.default,{src:e,width:100,height:100,alt:"notification image ".concat(t),className:"cursor-pointer max-w-[60px] 2xl:max-w-[80px] 2xl:h-[80px] object-cover rounded-lg mr-3",onClick:()=>window.open(e,"_blank")},t))}),(0,s.jsxs)("div",{className:"w-full text-[#705396] mt-2",children:[(0,s.jsxs)("p",{className:"2xl:my-2",children:["แจ้งคุณ ",c," ",x]}),(0,s.jsx)("p",{className:"2xl:my-2",children:"ข้อควรปฏิบัติก่อนรับการตรวจส่องกล้องลำไส้ใหญ่"}),(0,s.jsx)("div",{className:" break-words max-h-[18dvh] 2xl:max-h-[30dvh] overflow-y-auto",dangerouslySetInnerHTML:{__html:e.noti_detail||""}})]}),(0,s.jsxs)("button",{onClick:()=>en(e),className:"absolute top-0 left-56 text-white w-38 font-light btn btn-active mx-4 bg-[#693092] ",children:[(0,s.jsx)(p.default,{className:"gap-1",src:"/image/icon_edit.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:" Edit"})]})]},t)})}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",l?M.length:t.patient.med.length," รายการ"]}),(0,s.jsx)("div",{className:"".concat(A?"max-h-[34dvh] 2xl:max-h-[38dvh]":"max-h-[34dvh] 2xl:max-h-[40dvh]","  overflow-y-auto"),children:l?(0,s.jsx)("div",{children:M.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:"other"===e.name?"":E[e.id]||e.name||"",onChange:t=>ee(t,e.id),placeholder:"ระบุชื่อยา"}):(0,s.jsxs)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:e.name,onChange:t=>$(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"เลือกยา"}),k.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id)),(0,s.jsx)("option",{value:"other",children:"อื่นๆ"})]}),(0,s.jsxs)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",value:e.dose,onChange:t=>et(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"วัน"}),[...Array(7)].map((e,t)=>(0,s.jsxs)("option",{value:t+1,children:[t+1," วัน"]},t+1))]}),(0,s.jsx)("button",{className:"mx-1",onClick:()=>X(e.id),children:(0,s.jsx)(p.default,{src:"/image/icon_delete.png",alt:"delete medication",width:30,height:30})})]},e.id))}):(0,s.jsx)("div",{children:M.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] opacity-70 rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,placeholder:"ระบุชื่อยา"}):(0,s.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,children:(0,s.jsx)("option",{value:e.name,children:e.name})}),(0,s.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",defaultValue:e.dose,disabled:!0,children:(0,s.jsxs)("option",{value:e.dose,children:[e.dose," วัน"]})})]},e.id))})})]})})]})]}),(0,s.jsxs)("div",{className:" w-[45%]",children:[(0,s.jsxs)("div",{className:"flex pl-8",children:[(0,s.jsx)("div",{className:"w-[63.016%] ",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"Line Username"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] relative input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:S,readOnly:!0})})]})}),(0,s.jsx)("div",{className:"flex items-center pt-6",children:(0,s.jsx)("button",{onClick:ea,className:"relative text-white font-light bg-[#693092] btn btn-active mx-3",children:(0,s.jsx)(p.default,{src:"/image/icon_refresh.png",alt:"logo",width:30,height:30})})})]}),(0,s.jsx)(g,{visit_id:t.patient.visit_id,dailyDetail:t.daily_detail,notilist:R}),(0,s.jsx)(h,{isVisible:V,onClose:()=>{W(!1),J(Q&&Q.noti_detail||"")},title:"รายละเอียดการแจ้งเตือน",children:Q&&(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:["แจ้งเตือนคุณ ",Q.ptname]}),(0,s.jsxs)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:["วันที่ ",Q.date_before_appointment]}),(0,s.jsxs)("div",{className:"rounded bg-white min-h-[40dvh] 2xl:min-h-[48dvh] py-2 mt-2 text-xl mb-16",children:[(0,s.jsxs)("select",{className:"w-full mb-4 p-2 border rounded text-base",value:q,onChange:e=>{let t=parseInt(e.target.value,10);z(t);let a=R.find(e=>e.id===t);J(a?a.detail:"")},children:[(0,s.jsx)("option",{value:0,disabled:!0,children:"เลือกการแจ้งเตือน"}),R.map(e=>(0,s.jsx)("option",{value:e.id,children:e.header},e.id))]}),(0,s.jsx)(_,{className:"h-[280px] 2xl:h-[360px]",value:U,onChange:e=>J(e),theme:"snow"})]}),!o()(Q.date_before_appointment).isBefore(o()(),"day")&&(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsxs)("button",{onClick:ei,className:"relative text-white w-38 font-light btn btn-active mx-4 bg-[#693092]",children:[(0,s.jsx)(p.default,{className:"gap-2",src:"/image/icon_save.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:"Save"})]})})]})})]})]})]})})})};o().locale("th");var Y=e=>{let{items:t}=e,a=(0,i.useRouter)(),[l,c]=(0,n.useState)(!1),[m,x]=(0,n.useState)(t.patient.patient_fname),[h,u]=(0,n.useState)(t.patient.patient_lname),[j,v]=(0,n.useState)(t.patient.id_card),[_,F]=(0,n.useState)(o()(t.patient.dob)),[Y,B]=(0,n.useState)(""),[D,S]=(0,n.useState)(o()("".concat(t.patient.appointment_date.split("T")[0],"T").concat(t.patient.appointment_time))),[C,M]=(0,n.useState)(t.patient.line_name),[O,k]=(0,n.useState)([]),[T,E]=(0,n.useState)([]),[P,L]=(0,n.useState)({}),[H,A]=(0,n.useState)({}),[I,R]=(0,n.useState)(""),[Z,V]=(0,n.useState)([]);(0,n.useEffect)(()=>{l||S(o()("".concat(t.patient.appointment_date.split("T")[0],"T").concat(t.patient.appointment_time))),(async()=>{try{let e=(await d.Z.get("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","medical"))).data;if(E(e),t.patient.med){let a=t.patient.med.map((t,a)=>{let s=e.some(e=>e.name===t.medic);return{id:a,name:t.medic,dose:t.val,isOther:!s}});k(a)}}catch(e){console.error("Error fetching medical data:",e)}})();let e=setInterval(()=>{B((0,r.e)())},1e3);return()=>clearInterval(e)},[t.patient.appointment_date,t.patient.appointment_time,t.patient.med,l]);let W=e=>{k(O.filter(t=>t.id!==e))},Q=(e,t)=>{let a=e.target.value;O.some(e=>e.name===a&&e.id!==t&&"other"!==a)?f().fire({title:"ขออภัย",text:"รายการยานี้ถูกเลือกแล้ว",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}}):k(O.map(e=>{if(e.id===t){let t="other"===a||!T.some(e=>e.name===a);return{...e,name:a,isOther:t}}return e}))},G=(e,t)=>{L({...P,[t]:e.target.value}),k(O.map(a=>a.id===t?{...a,name:e.target.value}:a))},U=(e,t)=>{k(O.map(a=>a.id===t?{...a,dose:e.target.value}:a))},J=async()=>{let e={visit_id:t.patient.visit_id,userId:t.patient.line_id};try{let t=await d.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","visit/line/renew"),e);200===t.status?M(t.data.line_name):console.error("Failed to refresh data")}catch(e){console.error("Error while refreshing data:",e)}},q=async()=>{let e=O.some(e=>!e.name||!e.dose),t=o()().startOf("day"),a=_?o()(_).startOf("day"):null,s=a?t.diff(a,"years"):null;if(e){R("กรุณากรอกข้อมูลยาและจำนวนวันที่รับประทานให้ครบถ้วน");return}R("");let l={};if(m.trim()||(l.firstname="กรุณากรอกชื่อ"),h.trim()||(l.lastname="กรุณากรอกนามสกุล"),j.trim()?13!==j.trim().length&&(l.idCard="กรุณากรอกบัตรประจำตัวประชาชนให้ถูกต้อง (13 หลัก)"):l.idCard="กรุณากรอกบัตรประจำตัวประชาชน",_?(null===s||s<1)&&(l.birthDate="กรุณากรอกวันเดือนปีเกิดที่มากกว่าหรือเท่ากับ 1 ปี"):l.birthDate="กรุณากรอกวันเดือนปีเกิด",D?5>o().utc(D).startOf("day").diff(t,"days")&&(l.appointmentDate="กรุณากรอกวันนัดหมายที่มากกว่าวันปัจจุบัน 5 วัน"):l.appointmentDate="กรุณากรอกวันนัดหมาย",Object.keys(l).length>0){A(l);return}A({}),await z()},z=async()=>{let e=JSON.stringify(O.map(e=>({val:e.dose,medic:e.name}))),s=new FormData;s.append("fname",m),s.append("lname",h),s.append("idcard",j),s.append("dob",_?_.format("YYYY-MM-DD"):""),s.append("appointment_date",D?D.format("YYYY-MM-DD"):""),s.append("appointment_time",D?D.format("HH:mm:ss"):""),s.append("med",e),s.append("patient_id",t.patient.patient_id.toString());try{let e=await d.Z.post("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","visit/newappointment"),s);200===e.status?f().fire({title:"สำเร็จ",text:"คุณได้ทำรายการเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{a.push("/home/patient/view-patient?id=".concat(e.data.visit_id))}):f().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),f().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}};return(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 ",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:l?"กำหนดการใหม่":"ตรวจสำเร็จแล้ว"})}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("button",{onClick:l?q:()=>{c(!0)},className:"relative text-white w-38 font-light btn btn-active mx-4 bg-[#693092]",children:[(0,s.jsx)(p.default,{className:"gap-2",src:l?"/image/icon_save.png":"/image/icon_new_appointment.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:l?"Save":"New Appointment"})]})})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:" w-[55%]",children:[(0,s.jsxs)("form",{action:"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"".concat(l?"bg-white":"bg-[#F8F5FB]","  input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:m,onChange:e=>x(e.target.value)})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"นามสกุล"}),(0,s.jsx)("label",{className:"".concat(l?"bg-white":"bg-[#F8F5FB]","  input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:h,onChange:e=>u(e.target.value)})}),H.lastname&&(0,s.jsx)("span",{className:"text-red-500",children:H.lastname})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"".concat(l?"bg-white":"bg-[#F8F5FB]","  input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:j,maxLength:13,pattern:"\\d{13}",readOnly:!l,onChange:e=>v(e.target.value)})}),H.idCard&&(0,s.jsx)("span",{className:"text-red-500",children:H.idCard})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),l?(0,s.jsx)(w._,{dateAdapter:y.Q,children:(0,s.jsx)(b.M,{value:_,format:"DD-MM-YYYY",onChange:e=>F(e),disabled:!l,slotProps:{textField:{fullWidth:!0,className:"".concat(l?"":"bg-[#F8F5FB]"," rounded-lg text-[#705396] hover:border-gray-500 h-[48px]"),InputProps:{style:{borderRadius:"8px",color:"#705396"},className:"w-full rounded-lg text-[#705396] focus:border-gray-500 h-[48px]"}}}})}):(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:_?_.format("DD-MM-YYYY"):"",readOnly:!0})}),H.birthDate&&(0,s.jsx)("span",{className:"text-red-500",children:H.birthDate})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:l?Y:(0,r.p)(t.patient.register_date),readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),l?(0,s.jsx)(w._,{dateAdapter:y.Q,children:(0,s.jsx)(N.x,{value:D,format:"DD-MM-YYYY HH:mm:ss",onChange:e=>S(e),disabled:!l,slotProps:{textField:{fullWidth:!0,className:"".concat(l?"":"bg-[#F8F5FB]"," rounded-lg text-[#705396] hover:border-gray-500 h-[48px]"),InputProps:{style:{borderRadius:"8px",color:"#705396"},className:"w-full rounded-lg text-[#705396] focus:border-gray-500 h-[48px]"}}}})}):(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:D?D.format("DD-MM-YYYY HH:mm:ss"):"",readOnly:!0})}),H.appointmentDate&&(0,s.jsx)("span",{className:"text-red-500",children:H.appointmentDate})]})})]})]}),(0,s.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,s.jsxs)("div",{className:"flex h-[30px]",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ต้องหยุดรับประทาน"}),l&&(0,s.jsx)("button",{className:"mx-2",onClick:()=>{k([...O,{id:Date.now(),name:"",dose:"",isOther:!1}])},children:(0,s.jsx)(p.default,{src:"/image/icon_addplus.png",alt:"add medication",width:30,height:30})})]}),I&&(0,s.jsx)("span",{className:"text-red-500",children:I}),(0,s.jsxs)("div",{className:"rounded bg-[#E8DBF5] ".concat(I?"min-h-[38dvh] 2xl:min-h-[44dvh]":"min-h-[40dvh] 2xl:min-h-[46dvh]"," p-3"),children:[(0,s.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",l?O.length:t.patient.med.length," รายการ"]}),(0,s.jsx)("div",{className:"".concat(I?"max-h-[34dvh] 2xl:max-h-[38dvh]":"max-h-[34dvh] 2xl:max-h-[40dvh]"," overflow-y-auto"),children:l?(0,s.jsx)("div",{children:O.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:"other"===e.name?"":P[e.id]||e.name||"",onChange:t=>G(t,e.id),placeholder:"ระบุชื่อยา"}):(0,s.jsxs)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:e.name,onChange:t=>Q(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"เลือกยา"}),T.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id)),(0,s.jsx)("option",{value:"other",children:"อื่นๆ"})]}),(0,s.jsxs)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",value:e.dose,onChange:t=>U(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"วัน"}),[...Array(7)].map((e,t)=>(0,s.jsxs)("option",{value:t+1,children:[t+1," วัน"]},t+1))]}),(0,s.jsx)("button",{className:"mx-1",onClick:()=>W(e.id),children:(0,s.jsx)(p.default,{src:"/image/icon_delete.png",alt:"delete medication",width:30,height:30})})]},e.id))}):(0,s.jsx)("div",{children:O.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] opacity-70 rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,placeholder:"ระบุชื่อยา"}):(0,s.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,children:(0,s.jsx)("option",{value:e.name,children:e.name})}),(0,s.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",defaultValue:e.dose,disabled:!0,children:(0,s.jsxs)("option",{value:e.dose,children:[e.dose," วัน"]})})]},e.id))})})]})]})]}),(0,s.jsxs)("div",{className:" w-[45%]",children:[(0,s.jsxs)("div",{className:"flex pl-8",children:[(0,s.jsx)("div",{className:"w-[63.016%] ",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"Line Username"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] relative input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:C,readOnly:!0})})]})}),(0,s.jsx)("div",{className:"flex items-center pt-6",children:(0,s.jsx)("button",{onClick:J,className:"relative text-white font-light bg-[#693092] btn btn-active mx-3",children:(0,s.jsx)(p.default,{src:"/image/icon_refresh.png",alt:"logo",width:30,height:30})})})]}),!l&&(0,s.jsx)(g,{visit_id:t.patient.visit_id,dailyDetail:t.daily_detail,notilist:Z})]})]})]})})})},B=function(){let e=(0,i.useSearchParams)(),[t,a]=(0,n.useState)(""),[r,c]=(0,n.useState)(null),[o,p]=(0,n.useState)(!0),h=(0,n.useCallback)(async()=>{try{var t;let s=e.get("id"),l=await d.Z.get("".concat("https://city.planetcloud.cloud/citybackend/lineoa/","visit/task/").concat(s));c(l.data);let n=null===(t=l.data.patient)||void 0===t?void 0:t.state;"string"==typeof n&&a(n)}catch(e){console.error("Error fetching data:",e)}finally{p(!1)}},[e]);return((0,n.useEffect)(()=>{e.get("id")?h():p(!1)},[e,h]),o)?(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(l.default,{}),"OTP"===t?(0,s.jsx)(x.Z,{}):(0,s.jsx)(x.o,{})]}):(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(l.default,{}),"OTP"===t?r&&(0,s.jsx)(m,{items:r}):"Registered"===t?r&&(0,s.jsx)(F,{items:r,fetchDataview:h}):r&&(0,s.jsx)(Y,{items:r})]})}},18416:function(){}},function(e){e.O(0,[325,461,990,236,648,138,938,304,971,23,744],function(){return e(e.s=68259)}),_N_E=e.O()}]);